# The environment is not passed here because the user may not have ROOT setup
from init_env import init_environment
import os


if os.environ.get('ROOTSYS') is not None:
	ROOTSYS = os.environ['ROOTSYS']
else:
	ROOTSYS = "doesNotExist"

if os.path.exists(ROOTSYS):
	env = init_environment('glibrary qt5 clhep geant4 root')
else:
	Import('env')

txtSources = [
				  'factories/TEXT/gstreamerTEXTFactory.cc',
				  'factories/TEXT/gstreamerTEXTConnection.cc',
				  'factories/TEXT/gstreamerTEXTEvent.cc',
				  'factories/TEXT/gstreamerTEXTEventHeader.cc',
				  'factories/TEXT/gstreamerTEXTPublishTrueInfo.cc',
				  'factories/TEXT/gstreamerTEXTPublishDigitized.cc'
				  ]

# standard pre and suffix for gemc plugins
env.Replace(SHLIBSUFFIX = ".gplugin")
env.Replace(SHLIBPREFIX = "")

# destination library is one dir up - relative to this SConscript
txt_dll = env.Library(source = txtSources, target='gstreamerTEXTFactory')
env.Install('../lib', txt_dll)
